<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Protein Structure Prediction - Biological Modeling: A Free Online Course</title>
<meta name="description" content="A free and open online course in biological modeling at multiple scales.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Biological Modeling: A Free Online Course">
<meta property="og:title" content="Protein Structure Prediction">
<meta property="og:url" content="/coronavirus/more_RMSD">


  <meta property="og:description" content="A free and open online course in biological modeling at multiple scales.">












<link rel="canonical" href="/coronavirus/more_RMSD">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "/"
    
  }
</script>







<!-- end _includes/seo.html -->


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">



<!--SEO tagging -->
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Protein Structure Prediction | Biological Modeling: A Free Online Course</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Protein Structure Prediction" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A free and open online course in biological modeling at multiple scales." />
<meta property="og:description" content="A free and open online course in biological modeling at multiple scales." />
<meta property="og:site_name" content="Biological Modeling: A Free Online Course" />
<meta property="og:image" content="/assets/images/SARS_spike_proteins.jpg" />
<script type="application/ld+json">
{"description":"A free and open online course in biological modeling at multiple scales.","@type":"WebPage","url":"/coronavirus/more_RMSD","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/images/gray_scott_jupyter_3.png"}},"image":"/assets/images/SARS_spike_proteins.jpg","headline":"Protein Structure Prediction","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-173522486-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-173522486-1');
</script>

    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/">Biological Modeling: A Free Online Course</a>
        <ul class="visible-links">
                
                
                    <li class="masthead__menu-item">
                        <a href="/meet-the-team/">Course Team</a>
                    </li>
                
            
                
                
                    <li class="masthead__menu-item">
                        <a href="/contact/">Contact Us</a>
                    </li>
                
            
                
                
                    <li class="masthead__menu-item">
                        <a href="/contents/">Contents</a>
                    </li>
                
            
                
                
                    <li class="dropdown ">
                        <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Take the Course    <i class="fa fa-caret-down fa-sm" aria-hidden="true"></i><span class="caret"></span></a>
                        <ul class="dropdown-content">
                            
                                <li>
                                    <a href="/prologue/">    <b>Prologue:</b> an introduction to biological modeling via random walks and Turing patterns</a>
                                </li>
                            
                                <li>
                                    <a href="/motifs/home">    <b>Module 1:</b> Finding motifs in transcription factor networks</a>
                                </li>
                            
                                <li>
                                    <a href="/chemotaxis/home">    <b>Module 2:</b> Unpacking E. coli's genius exploration algorithm</a>
                                </li>
                            
                                <li>
                                    <a href="/coronavirus/home">    <b>Module 3:</b> Analyzing the coronavirus spike protein</a>
                                </li>
                            
                                <li>
                                    <a href="">    <b>Module 4:</b> coming soon!</a>
                                </li>
                            
                        </ul>
                    </li>
                
            
        </ul>
        
        <button class="search__toggle" type="button">
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">

  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Analyzing the coronavirus spike protein</span>
        

        
        <ul>
          
            <li><a href="/coronavirus/home">Introduction: A tale of two doctors<br><br></a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Part 1: Protein Structure Prediction</span>
        

        
        <ul>
          
            <li><a href="/coronavirus/structure_intro">An introduction to protein structure prediction<br><br></a></li>
          
            <li><a href="/coronavirus/ab_initio">Ab initio protein structure prediction<br><br></a></li>
          
            <li><a href="/coronavirus/homology">Homology modeling for protein structure prediction<br><br></a></li>
          
            <li><a href="/coronavirus/accuracy">Comparing protein structures to assess model accuracy<br><br></a></li>
          
            <li><a href="/coronavirus/conclusion_part_1">Part 1 conclusion: protein structure prediction is solved! (Kindaâ€¦)<br><br></a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Part 2: Comparing SARS-CoV-2 and SARS</span>
        

        
        <ul>
          
            <li><a href="/coronavirus/multiseq">Searching for local differences in the SARS-CoV and SARS-CoV-2 spike proteins<br><br></a></li>
          
            <li><a href="/coronavirus/structural_diff">Analyzing structural differences in the bonding of SARS-CoV and SARS-CoV-2 with the ACE2 enzyme<br><br></a></li>
          
            <li><a href="/coronavirus/NAMD">Quantifying the interaction energy between the SARS-CoV-2 spike protein and ACE2<br><br></a></li>
          
            <li><a href="/coronavirus/conclusion_part_2">Part 2 conclusion: from static protein analysis to molecular dynamics<br><br></a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Software Tutorials (featuring ProDy)</span>
        

        
        <ul>
          
            <li><a href="/coronavirus/tutorial_ab_initio">Using ab initio modeling to predict the structure of hemoglobin subunit alpha<br><br></a></li>
          
            <li><a href="/coronavirus/tutorial_homology">Using homology modeling to predict the structure of the SARS-CoV-2 spike protein<br><br></a></li>
          
            <li><a href="/coronavirus/tutorial_rmsd">Using RMSD to compare the predicted SARS-CoV-2 spike protein against its experimentally validated structure<br><br></a></li>
          
            <li><a href="/coronavirus/tutorial_multiseq">Finding local differences in the SARS-CoV and SARS-CoV-2 spike protein structures<br><br></a></li>
          
            <li><a href="/coronavirus/tutorial_visualization">Visualizing specific regions of interest within the spike protein structure<br><br></a></li>
          
            <li><a href="/coronavirus/tutorial_NAMD">Computing the energy contributed by a local region of the SARS-CoV-2 spike protein bound with the human ACE2 enzyme<br><br></a></li>
          
            <li><a href="/coronavirus/tutorial_GNM">Analysis of coronavirus spike proteins using GNM<br><br></a></li>
          
            <li><a href="/coronavirus/tutorial_ANM">Adding directionality to spike protein GNM simulations using ANM<br><br></a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Protein Structure Prediction">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Protein Structure Prediction
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#how-it-works-kabsch-algorithm-partial-procrustes-superimposition">How it Works: Kabsch Algorithm (Partial Procrustes Superimposition)</a><ul><li><a href="#input">Input</a></li><li><a href="#translation-step">Translation Step</a></li><li><a href="#covariance-step">Covariance Step</a></li><li><a href="#singluar-value-decomposition-svd-step">Singluar Value Decomposition (SVD) Step</a></li></ul></li></ul>

            </nav>
          </aside>
        
        <p>To use RMSD as a quantitative measure for comparing protein structures, the structures must first be superposed in such a way that the RMSD is minimized.</p>

<p>Back in the tutorial, superposing was accomplished by utilizing the <em>calcTransformation()</em> function, which returns the optimal transformation matrix between two structures such that the RMSD is minimized. This transformation matrix is consists of translation vector and rotation matrix, which can be calculated using the Kabsch Algorithm.</p>

<p>The source code for <em>calcTransformation()</em> can be found
<a href="http://prody.csb.pitt.edu/_modules/prody/measure/transform.html#calcTransformation" target="_blank">here</a>.</p>

<h2 id="how-it-works-kabsch-algorithm-partial-procrustes-superimposition">How it Works: Kabsch Algorithm (Partial Procrustes Superimposition)</h2>

<p>The Kabsch Algorithm is an algorithm that finds the optimal rotation matrix in which the RMSD between two paired sets of points is minimized (the two sets must have the same number of points). In our case, the two sets of points are the 3D coordinate points of the CÎ± (carbon skeleton) of the two protein structures that we want to compare. The algorithm can be broken down into three major steps: Translation, Covariance, and Singular Value Decomposition.</p>

<h3 id="input">Input</h3>
<p>The input will be a (N x 3) matrix for each set of points, where N is the number of points per set. The three column represent the 3D coordinate set per N points.</p>

<h3 id="translation-step">Translation Step</h3>
<p>Each set of points is translated such that their centroid lies on the origin of the coordinate system. This is easily done by subtracting the coordinates of the centroid from the respective point coordinates.</p>

<h3 id="covariance-step">Covariance Step</h3>
<p>The next step is to calculate the cross-covariance matrix. Let H be the cross-covariance matrix, and P and Q be the two translated input matrixes such that for the result of the algorithm, P will be rotated into Q.</p>

<p><a href="https://www.codecogs.com/eqnedit.php?latex=\large&space;H&space;=&space;P^{T}Q" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\large&space;H&space;=&space;P^{T}Q" title="\large H = P^{T}Q" /></a></p>

<p>Or in summation notation:</p>

<p><a href="https://www.codecogs.com/eqnedit.php?latex=\large&space;H_{i,j}&space;=&space;\sum_{N}^{k=1}&space;P_{k,i}&space;Q_{k,j}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\large&space;H_{i,j}&space;=&space;\sum_{N}^{k=1}&space;P_{k,i}&space;Q_{k,j}" title="\large H_{i,j} = \sum_{N}^{k=1} P_{k,i} Q_{k,j}" /></a></p>

<h3 id="singluar-value-decomposition-svd-step">Singluar Value Decomposition (SVD) Step</h3>
<p>It is possible to get the optimal rotation matrix, R, with the formula:</p>

<p><a href="https://www.codecogs.com/eqnedit.php?latex=\large&space;R&space;=&space;(H^TH)^{\frac{1}{2}}H^{-1}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\large&space;R&space;=&space;(H^TH)^{\frac{1}{2}}H^{-1}" title="\large R = (H^TH)^{\frac{1}{2}}H^{-1}" /></a></p>

<p>However, this is not always possible and can become quite complicated (e.g. H not having an inverse). Another method is to use singular value decomposition of the covariance matrix. Kabsch algorith utilizes SVD of H to compute R:</p>

<p><a href="https://www.codecogs.com/eqnedit.php?latex=\large&space;H&space;=&space;VSW^T" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\large&space;H&space;=&space;VSW^T" title="\large H = VSW^T" /></a></p>

<p>In order to ensure that the rotation matrix is a right-handed coordinate system, the matrix may need to be corrected by calculating the determinant of the dot product of W and V<sup>T</sup>:</p>

<p><a href="https://www.codecogs.com/eqnedit.php?latex=\large&space;d&space;=&space;sign(det(WV^T))" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\large&space;d&space;=&space;sign(det(WV^T))" title="\large d = sign(det(WV^T))" /></a></p>

<p>Finally, R can be calculated with the following matrix formula:</p>

<p><a href="https://www.codecogs.com/eqnedit.php?latex=\large&space;R&space;=&space;W\bigl(\begin{smallmatrix}&space;1&space;&amp;&space;0&space;&amp;&space;0\\&space;0&space;&amp;&space;1&space;&amp;&space;0\\&space;0&space;&amp;&space;0&space;&amp;&space;d&space;\end{smallmatrix}\bigr)&space;V^T" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\large&space;R&space;=&space;W\bigl(\begin{smallmatrix}&space;1&space;&amp;&space;0&space;&amp;&space;0\\&space;0&space;&amp;&space;1&space;&amp;&space;0\\&space;0&space;&amp;&space;0&space;&amp;&space;d&space;\end{smallmatrix}\bigr)&space;V^T" title="\large R = W\bigl(\begin{smallmatrix} 1 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; d \end{smallmatrix}\bigr) V^T" /></a></p>

<p style="font-size: 100%; text-align: center;"><a href="accuracy" class="btn btn--primary btn--large">Return to main text</a></p>

        
      </section>

      <footer class="page__meta">
        
        


        

      </footer>

      

      
    </div>

    
  </article>

  <!-- only show related on a post page when `related: true`
  
  
  -->
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="search-searchbar"></div>
  <div class="search-hits"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <hr>
  <table>
<tbody>
<tr>
<td><a href="http://cbd.cmu.edu" target="_blank"><img src="../assets/images/CMU_CBD_logos.png" alt="CBD Logo"></a></td>
<td><a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</a></td>
<td><a href="http://mmbios.pitt.edu" target="_blank"><img src="../assets/images/MMBioS_Logo.png" alt="MMBioS Logo"></a></td>
</tr>
</tbody>
</table>
</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>


<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch-theme-algolia.min.css">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  appId: 'O24616B64D',
  apiKey: '3d5df9a350e2a9a5039314b58ef8c32d',
  indexName: 'biological_modeling',
  searchParameters: {
    restrictSearchableAttributes: [
      'title',
      'content'
    ]
  }
});

const hitTemplate = function(hit) {
  const url = hit.url;
  const title = hit._highlightResult.title.value;
  const content = hit._highlightResult.html.value;

  return `
    <div class="list__item">
      <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
        <h2 class="archive__item-title" itemprop="headline"><a href="${url}">${title}</a></h2>
        <div class="archive__item-excerpt" itemprop="description">${content}</div>
      </article>
    </div>
  `;
}

// Adding searchbar and results widgets
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '.search-searchbar',
    poweredBy: true,
    placeholder: 'Enter your search term...'
  })
);
search.addWidget(
  instantsearch.widgets.hits({
    container: '.search-hits',
    templates: {
      item: hitTemplate,
      empty: 'No results',
    }
  })
);

// Starting the search only when toggle is clicked
$(document).ready(function () {
  $(".search__toggle").on("click", function() {
    if(!search.started) {
      search.start();
    }
  });
});
</script>








  </body>
</html>
