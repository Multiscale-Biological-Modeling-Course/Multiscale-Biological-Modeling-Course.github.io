<!-- Book-support modal -->
<div id="book-modal" class="bm-modal" aria-hidden="true">
    <div class="bm-dialog" role="dialog" aria-labelledby="bm-title">
  
      <!-- close “X” -->
      <button class="bm-close" aria-label="Close" onclick="bmClose()">
        <i class="fas fa-times"></i>
      </button>
  
      <!-- NEW: cover image -->
      <img src="{{ '/assets/images/cover_3d_paperback.jpg' | relative_url }}"
           alt="Biological Modeling book cover"
           class="bm-cover">
  
      <h3 id="bm-title">Enjoying <em>Biological Modeling</em>?</h3>
  
      <p class="bm-blurb">
        Grab the companion E-book from Leanpub or the print edition from Amazon.
      </p>
  
      <!-- CTA buttons -->
      <div class="bm-cta">
        <a href="https://leanpub.com/biologicalmodeling"
           class="btn btn--primary btn--large bm-btn"
           target="_blank" rel="noopener">
          Leanpub&nbsp;E-book&nbsp;($9.95)
        </a>
  
        <a href="https://www.amazon.com/dp/B0BT6B2B8W"
           class="btn btn--primary btn--large bm-btn"
           target="_blank" rel="noopener">
          <i class="fab fa-amazon bm-icon" aria-hidden="true"></i>
          Print Companion
        </a>
      </div>
  
      <!-- Social share -->
      <div class="bm-share">
        <h3 id="bm-title">Share our project!</h3>
        {% assign linkedin_text = "Explore this free biological-modeling course!" | url_encode %}
        {% assign x_text       = "Check out this awesome free resource on biological modeling!" | url_encode %}
        {% assign reddit_text  = "Great free website that teaches biological modeling through projects." | url_encode %}
  
        <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ page.url | absolute_url }}&title={{ linkedin_text }}" target="_blank" rel="noopener"><i class="fab fa-linkedin"></i></a>
        <a href="https://twitter.com/intent/tweet?text={{ x_text }}&url={{ page.url | absolute_url }}"                 target="_blank" rel="noopener"><i class="fab fa-twitter"></i></a>
        <a href="https://www.reddit.com/submit?url={{ page.url | absolute_url }}&title={{ reddit_text }}"             target="_blank" rel="noopener"><i class="fab fa-reddit"></i></a>
        <a href="https://www.facebook.com/sharer/sharer.php?u={{ page.url | absolute_url }}"                           target="_blank" rel="noopener"><i class="fab fa-facebook"></i></a>
        <button class="bm-copy" aria-label="Copy page link" onclick="bmCopyLink()">
            <i class="fas fa-link"></i>
          </button>
          <span id="bm-copied" class="bm-copied" aria-hidden="true">Copied!</span>
      </div>
  
    </div>
  </div>
  
  <div id="bm-backdrop" class="bm-backdrop" onclick="bmClose()"></div>

  <script>
    function bmOpen() {
      document.getElementById('book-modal' ).setAttribute('aria-hidden','false');
      document.getElementById('bm-backdrop').style.display = 'block';
    }
    function bmClose() {
      document.getElementById('book-modal' ).setAttribute('aria-hidden','true');
      document.getElementById('bm-backdrop').style.display = 'none';
    }
    function bmSetCookie(days) {
      const d = new Date();
      d.setTime(d.getTime()+ days*864e5);
      document.cookie = "bmShown=true; expires="+d.toUTCString()+"; path=/";
    }
    function bmGetCookie() {
      return document.cookie.split(';').some(c=>c.trim().startsWith("bmShown="));
    }
    window.addEventListener('load', () => {
      if (!bmGetCookie()) {
        setTimeout(() => { bmOpen(); bmSetCookie(1); }, 60000); // 60 s then once/day
      }
    });
    </script>

<!-- this is for copying a link to the clipboard for sharing -->
<script>
    function bmCopyLink(){
  const url = window.location.href;
  navigator.clipboard.writeText(url).then(()=>{
    document.querySelectorAll('.bm-copied').forEach(el=>{
      el.setAttribute('aria-hidden','false');
      el.classList.add('show');
      setTimeout(()=>{ el.classList.remove('show');
                       el.setAttribute('aria-hidden','true'); }, 2000);
    });
  }).catch(()=>alert('Copy failed – please copy manually'));
}
</script>